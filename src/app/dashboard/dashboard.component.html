<div class="dashboard-header">
  <h1>ðŸ’¸ OOpsMyMoney</h1>
  <p>Track your spending. Rule your wallet. Stay fabulous ðŸ’…</p>
</div>

<!-- Stat Summary Layout -->
<div class="stat-summary-container">
  <div class="main-stat">
    <div class="label">This Month</div>
    <div class="value">â‚¹{{ monthlyTotal }}</div>
  </div>
  <div class="side-stats">
    <div class="side-stat">
      <div class="label small">This Year</div>
      <div class="value small">â‚¹{{ yearlyTotal }}</div>
    </div>
    <div class="side-stat">
      <div class="label small">All Time</div>
      <div class="value small">â‚¹{{ totalSpent }}</div>
    </div>
  </div>
</div>

<!-- Add Expense Toggle -->
<!-- <button (click)="showForm = !showForm">
  {{ showForm ? 'Cancel' : 'Add Expense' }}
</button> -->

<button class="button button-item" type="submit" (click)="showForm = !showForm">
  <span class="button-bg">
    <span class="button-bg-layers">
      <span class="button-bg-layer button-bg-layer-1 -purple"></span>
      <span class="button-bg-layer button-bg-layer-2 -turquoise"></span>
      <span class="button-bg-layer button-bg-layer-3 -yellow"></span>
    </span>
  </span>
  <span class="button-inner">
    
    <span class="button-inner-static">{{ showForm ? 'Cancel' : 'Add Expense' }}</span>
    
    <span class="button-inner-hover">Add Expense</span>
    
  </span>
</button>



<!-- Add Expense Form -->
<form *ngIf="showForm" (submit)="submitExpense($event)" class="add-expense-form">
  <div>
    <label>Amount:</label>
    <input type="number" [(ngModel)]="newExpense.amount" name="amount" required />
  </div>

  <div>
    <label>Category:</label>
    <select [(ngModel)]="newExpense.category" name="category" required>
      <option value="" disabled selected>Select category</option>
      <option *ngFor="let cat of categories" [value]="cat">{{ cat }}</option>
    </select>
    <div class="toggle-new-category" (click)="showCategoryInput = !showCategoryInput">
      + {{ showCategoryInput ? 'Cancel' : 'Add new category' }}
    </div>
  </div>

  <div *ngIf="showCategoryInput">
    <input type="text" [(ngModel)]="newCategory" name="newCategory" placeholder="New category name" />
    <button type="button" (click)="addCategory()">Save Category</button>
  </div>

  <!-- <button type="submit">Add Expense</button> -->

  <!-- From Uiverse.io by OliverZeros --> 
<button class="button button-item" type="submit">
  <span class="button-bg">
    <span class="button-bg-layers">
      <span class="button-bg-layer button-bg-layer-1 -purple"></span>
      <span class="button-bg-layer button-bg-layer-2 -turquoise"></span>
      <span class="button-bg-layer button-bg-layer-3 -yellow"></span>
    </span>
  </span>
  <span class="button-inner">
    <span class="button-inner-static">Add Expense</span>
    <span class="button-inner-hover">Add Expense</span>
  </span>
</button>


     
</form>
<br>
<!-- Filter -->
<div class="filter-section">
  <label>Filter by:</label>
  <select [(ngModel)]="filterOption" (change)="applyFilter()">
    <option value="thisMonth">This Month</option>
    <option value="lastMonth">Last Month</option>
    <option value="thisYear">This Year</option>
    <option value="all">All Time</option>
  </select>
</div>

<!-- Spending by Category -->
<h3>Spending by Category</h3>
<ul class="category-totals">
  <li *ngFor="let key of categoryKeys()">
    {{ key }}: â‚¹{{ categoryTotals[key] }}
  </li>
</ul>

<!-- Pie Chart -->
<!-- Bar Chart -->
<button (click)="toggleChartType()">
  Switch to {{ chartType === 'pie' ? 'Bar' : 'Pie' }} Chart
</button>

<div class="chart-wrapper">
  <canvas baseChart
  [data]="{ labels: chartLabels, datasets: [{ data: chartData, backgroundColor: ['#ff6384', '#36a2eb', '#ffce56', '#8e44ad', '#2ecc71', '#e67e22'] }] }"
  [type]="chartType"
  [options]="chartOptions">
</canvas>

</div>



<!-- Expense List -->
<h3>All Expenses</h3>
<ul class="expense-list">
  <li *ngFor="let exp of filteredExpenses">
    â‚¹{{ exp.amount }} - {{ exp.category }} - {{ exp.date | date:'shortDate' }}
    <button (click)="editExpense(exp)">Edit</button>
    <button (click)="deleteExpense(exp)">Delete</button>
  </li>
</ul>

<!-- Edit Form -->
<div *ngIf="editingExpense" class="edit-form">
  <h4>Edit Expense</h4>
  <form (ngSubmit)="submitEdit()">
    <input type="number" [(ngModel)]="editingExpense.amount" name="editAmount" required />
    <select [(ngModel)]="editingExpense.category" name="editCategory">
      <option *ngFor="let cat of categories" [value]="cat">{{ cat }}</option>
    </select>
    <button type="submit">Save</button>
    <button type="button" (click)="cancelEdit()">Cancel</button>
  </form>
</div>
<app-stat-box label="All Time" [value]="totalSpent"></app-stat-box>
